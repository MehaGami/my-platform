apiVersion: networking.k8s.io/v1
kind: Ingress
metadata:
  name: argocd-server-custom
  namespace: argocd
  annotations:
    # REWRITE LOGIC REMOVED
    # We pass the full path to ArgoCD and let it handle the rootpath natively.

    # Basic SSL offload config
    nginx.ingress.kubernetes.io/ssl-redirect: "false"
    nginx.ingress.kubernetes.io/backend-protocol: "HTTP"

spec:
  ingressClassName: nginx
  rules:
    - host: my-platform.local
      http:
        paths:
          - path: /argocd
            pathType: Prefix
            backend:
              service:
                # Name of the service generated by the subchart.
                # Usually: {release-name}-{chart-name}-server
                name: argocd-server
                port:
                  number: 80
